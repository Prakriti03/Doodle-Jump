var g=Object.defineProperty;var f=(h,t,i)=>t in h?g(h,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):h[t]=i;var e=(h,t,i)=>(f(h,typeof t!="symbol"?t+"":t,i),i);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const p of o.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&a(p)}).observe(document,{childList:!0,subtree:!0});function i(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(r){if(r.ep)return;r.ep=!0;const o=i(r);fetch(r.href,o)}})();const n={CANVAS_WIDTH:450,CANVAS_HEIGHT:650},d=30;class y{constructor(){e(this,"posX");e(this,"posY");e(this,"velocity");e(this,"gravity");e(this,"jumpStrength");e(this,"isJumping");e(this,"hasJumpedOnce");e(this,"doodlerImg");e(this,"width");e(this,"height");e(this,"doodlerDir");this.posX=10,this.posY=300,this.velocity=0,this.gravity=.7,this.jumpStrength=-15,this.isJumping=!1,this.hasJumpedOnce=!1,this.doodlerImg=new Image,this.width=60,this.height=60,this.doodlerDir="Straight",this.doodlerImg.src="blueT.png"}draw(){this.doodlerDir=="Straight"?this.doodlerImg.src="blueT.png":this.doodlerDir==="Left"?this.doodlerImg.src="blueL.png":this.doodlerImg.src="blueR.png",l.drawImage(this.doodlerImg,this.posX,this.posY,this.width,this.height)}moveLeft(){this.doodlerDir="Left",this.posX+this.width<0&&(this.posX=n.CANVAS_WIDTH),this.posX-=5}moveRight(){this.doodlerDir="Right",this.posX+=5,this.posX>n.CANVAS_WIDTH&&(this.posX=-this.width)}jump(){this.isJumping||(this.isJumping=!0,this.velocity=this.jumpStrength)}}function u(h,t){const i=Math.ceil(h),a=Math.floor(t);return Math.floor(Math.random()*(a-i)+i)}class w{constructor(t,i){e(this,"x");e(this,"y");e(this,"height");e(this,"width");e(this,"platformImg");this.x=t,this.y=i,this.height=15,this.width=60,this.platformImg=new Image,this.platformImg.src="platform.png"}draw(){l.drawImage(this.platformImg,this.x,this.y,this.width,this.height)}}function c(h){const t=u(d*2,n.CANVAS_WIDTH-d*2);return new w(t,h)}class I{constructor(t){e(this,"ctx");e(this,"score");this.ctx=t,this.score=0}increment(){this.score+=10,this.draw(),console.log(this.score)}draw(){this.ctx.fillStyle="white",this.ctx.font="20px Proxima Nova",this.ctx.fillText(`Score: ${this.score}`,20,30)}}class m{constructor(){e(this,"player");e(this,"platforms");e(this,"isGameOver");e(this,"threshold");e(this,"backgroundImg");e(this,"score");this.player=new y,this.platforms=[],this.isGameOver=!1,this.threshold=s.height/2,this.backgroundImg=new Image,this.backgroundImg.src="bg.png",this.score=new I(l)}createInitialPlatforms(t,i){let a=i/t;for(let r=0;r<t;r++){let o=i-(r+1)*a;this.platforms.push(c(o))}}checkCollision(){for(let t of this.platforms)if(this.player.posY+this.player.height>=t.y&&this.player.posY+this.player.height<=t.y+t.height&&this.player.posX+this.player.width>t.x&&this.player.posX<t.x+t.width)return this.player.hasJumpedOnce=!0,t;return null}drawGameOver(){l.clearRect(0,0,s.width,s.height),l.font="48px Arial",l.fillStyle="red",l.textAlign="center",l.fillText("Game Over",s.width/2,s.height/2),l.font="30px Proxima Nova",l.fillStyle="red",l.textAlign="center",l.fillText("Press Enter to Restart",s.width/2,s.height/2+50),requestAnimationFrame(this.drawGameOver.bind(this))}update(){if(this.isGameOver)return;this.player.velocity+=this.player.gravity,this.player.posY+=this.player.velocity;const t=this.checkCollision();if(t&&this.player.velocity>0&&(this.player.posY=t.y-this.player.height,this.player.velocity=this.player.jumpStrength),this.player.hasJumpedOnce&&this.player.posY>s.height-60){this.isGameOver=!0,this.drawGameOver();return}if(this.player.posY>s.height-this.player.height&&(this.player.posY=s.height-this.player.width,this.player.isJumping=!1,this.player.jump()),this.player.posY<this.threshold){let i=this.threshold-this.player.posY;this.player.posY=this.threshold,this.platforms.forEach(o=>{o.y+=i});const a=this.platforms.length;for(this.platforms=this.platforms.filter(o=>o.y<s.height),a-this.platforms.length>0&&this.score.increment();this.platforms.length<8;){let o=this.platforms.length>0?this.platforms[this.platforms.length-1].y-Math.floor(Math.random()*80+20):s.height-60;this.platforms.push(c(o))}}l.drawImage(this.backgroundImg,0,0,s.width,s.height),this.player.posX+this.player.width<0&&(this.player.posX=s.width),this.player.posX>s.width&&(this.player.posX=-60),this.score.draw(),this.player.draw(),this.platforms.forEach(i=>i.draw()),requestAnimationFrame(this.update.bind(this))}start(){window.addEventListener("keydown",t=>{if(!this.isGameOver)switch(t.key){case"ArrowLeft":this.player.moveLeft();break;case"ArrowRight":this.player.moveRight();break;case" ":this.player.jump();break}}),this.createInitialPlatforms(8,s.height),this.player.doodlerImg.onload=()=>{console.log("loaded"),this.backgroundImg.onload=()=>{this.update()}}}}const s=document.querySelector("#gameCanvas"),l=s.getContext("2d"),v=document.getElementById("start-screen"),x=document.getElementById("start-button");s.height=n.CANVAS_HEIGHT;s.width=n.CANVAS_WIDTH;x.addEventListener("click",()=>{v.style.display="none",s.style.display="flex";const h=new m;console.log(h),h.start()});window.addEventListener("keydown",h=>{h.key==="Enter"&&new m().start()});
